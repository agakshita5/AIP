{% extends "base.html" %}

{% block title %}Defend Models | Adversarial Shield{% endblock %}

{% block content %}
<div class="tool-container">
    <h2><i class="fas fa-shield-alt"></i> Defend Against Attacks</h2>
    <p class="subtitle">Apply Gaussian Blur to protect your models against adversarial attacks</p>
    
    <div class="upload-section">
        <div class="upload-container">
            <div class="upload-box" id="uploadBox">
                <i class="fas fa-cloud-upload-alt upload-icon"></i>
                <p class="upload-text">Drag & drop a perturbed image or click to browse</p>
                <input type="file" id="imageUpload" accept="image/*" required>
            </div>
            <div class="upload-preview" id="uploadPreview">
                <img id="previewImage" class="preview-image">
                <div class="preview-overlay">
                    <button class="btn-clear" id="clearPreview" type="button"><i class="fas fa-times"></i></button>
                </div>
            </div>
        </div>
    </div>

    <button class="btn-process" id="defendBtn" type="button">
        <i class="fas fa-shield-alt"></i> Defend Image
    </button>

    <div id="results" class="results-container" style="display:none;">
        <div class="row">
            <div class="col-md-6 result-column">
                <div class="result-card">
                    <h4>Perturbed Image</h4>
                    <img id="perturbedImage" class="result-image">
                    <div class="predictions">
                        <strong>Predictions:</strong>
                        <div id="perturbedPred"></div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 result-column">
                <div class="result-card">
                    <h4>Defended Image</h4>
                    <img id="defendedImage" class="result-image">
                    <div class="predictions">
                        <strong>Predictions:</strong>
                        <div id="defendedPred"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <p>Applying defense...</p>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/main.js') }}"></script>
{% endblock %}
